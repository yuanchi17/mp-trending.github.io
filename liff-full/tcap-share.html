<!doctype html><html><head><meta charset="UTF-8"><meta content="IE=edge" http-equiv="X-UA-Compatible"><meta content="width=device-width,initial-scale=1,minimum-scale=1,maximum-scale=1,viewport-fit=cover,user-scalable=no" name="viewport"><title>臺北市立兒童新樂園</title><meta content="臺北市立兒童新樂園。" name="description"><meta content="臺北市立兒童新樂園。" property="og:description"><meta content="zh_TW" property="og:locale"><meta content="微程式資訊 創新前瞻計畫室" property="og:site_name"><meta content="臺北市立兒童新樂園" property="og:title"><meta content="website" property="og:type"><link href="https://unpkg.com/bootstrap@4/dist/css/bootstrap.min.css" rel="stylesheet"><link href="https://unpkg.com/font-awesome@4/css/font-awesome.min.css" rel="stylesheet"><link href="https://fonts.googleapis.com/css2?family=Noto+Sans+TC:wght@400;700&display=swap" rel="stylesheet"><style>[v-cloak]{display:none}.h1,.h2,.h3,.h4,.h5,.h6,body,h1,h2,h3,h4,h5,h6{font-family:"Noto Sans TC",sans-serif}</style><meta content="https://liff.line.me/1655757631-QKOK03Dx/tcap-share.html" property="og:url"><style>body{background-color:#f2f6f9}</style></head><body><script src="https://www.googletagmanager.com/gtag/js?id=G-SYT6P9ENET" async></script><script>function gtag(){window.dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],window.GA_MEASUREMENT_ID="G-SYT6P9ENET",gtag("js",new Date),gtag("config",window.GA_MEASUREMENT_ID,{send_page_view:!1}),(async()=>{let e=100;for(;e--&&(!window.liff||!window.liff.getVersion);)await(i=>new Promise(e=>{setTimeout(e,i)}))(100);const i=window.liff;gtag("set","user_properties",{liffVersion:i.getVersion(),...i.isInClient()?{lineVersion:i.getLineVersion()}:{}})})();</script><script src="https://static.line-scdn.net/liff/edge/2/sdk.js" crossorigin="anonymous"></script><script src="https://unpkg.com/axios/dist/axios.min.js" crossorigin="anonymous"></script><script src="https://unpkg.com/dayjs/dayjs.min.js" crossorigin="anonymous"></script><script src="https://unpkg.com/jquery@3/dist/jquery.min.js" crossorigin="anonymous"></script><script src="https://unpkg.com/js-base64@2/base64.min.js" crossorigin="anonymous"></script><script src="https://unpkg.com/json5@2/dist/index.min.js" crossorigin="anonymous"></script><script src="https://unpkg.com/lodash@4/lodash.min.js" crossorigin="anonymous"></script><script src="https://unpkg.com/popper.js@1/dist/umd/popper.min.js" crossorigin="anonymous"></script><script src="https://unpkg.com/qs@6/dist/qs.js" crossorigin="anonymous"></script><script src="https://unpkg.com/sweetalert2@11" crossorigin="anonymous"></script><script src="https://unpkg.com/vue@2/dist/vue.min.js" crossorigin="anonymous"></script><script src="https://unpkg.com/papaparse@5/papaparse.min.js" crossorigin="anonymous"></script><script src="https://unpkg.com/bootstrap@4/dist/js/bootstrap.min.js" crossorigin="anonymous"></script><script src="https://yuanchi17.github.io/mp-trending.github.io/js/common.js?cachebust=1643003621191"></script><script>window.errToPlainObj=(()=>{const e=["address","code","data","dest","errno","info","message","name","path","port","reason","response.data","response.headers","response.status","stack","status","statusCode","statusMessage","syscall"];return s=>_.pick(s,e)})();</script><script>const loginPromise=(async()=>{if(await liff.init({liffId:"1655757631-QKOK03Dx"}),!liff.isLoggedIn())return liff.login({redirectUri:location.href}),new Promise(e=>{});let e={};try{e=await liff.getProfile(),gtag("set","user_id",e.userId)}catch(e){console.error(window.errToPlainObj(e))}return e})();window.vm=new Vue({el:"#app",data:{},async mounted(){try{var e=this.paramBase64url("redirect");e&&localStorage.setItem("tcap-redirect",e),await this.initTpl(),await this.init()}catch(e){console.error(window.errToPlainObj(e)),await Swal.fire({icon:"error",title:"網頁讀取失敗",text:e.message})}},methods:{async init(){this.showLoading("請稍候","載入中"),await loginPromise,await this.btnShare();var e=new URL(localStorage.getItem("tcap-redirect")||"../tcap/page-1-4.html",location).href;localStorage.removeItem("tcap-redirect"),liff.openWindow({external:!0,url:e})},async initTpl(){var e=new URL("../tpl/tcap-share.txt",location).href;const t=_.template(_.get(await axios.get(e,{params:{cachebust:Date.now()},transformResponse:[]}),"data"));this.render=e=>t({_:_,dayjs:dayjs,Qs:Qs,...e})},async btnShare(){try{if(this.showLoading("請稍候","正在開啟分享畫面"),!liff.isApiAvailable("shareTargetPicker"))throw new Error("您的裝置不支援此功能，請嘗試重新開啟此頁面或更新應用程式版本。");var e=await loginPromise,t=this.getRenderedMsgs({profile:e,url:new URL("../tcap/page-6-1.html?openExternalBrowser=1",location).href}),a=Date.now(),r=await liff.shareTargetPicker(t);if(1e3<Date.now()-a&&"success"!==_.get(r,"status"))throw new Error("您已取消分享");await Swal.fire({icon:"success",title:"分享行程成功",text:"祝你們玩得愉快"})}catch(e){e.message=_.get(e,"response.data.message",e.message),console.error(window.errToPlainObj(e)),await Swal.fire({icon:"error",title:"分享行程失敗",text:e.message})}},getRenderedMsgs(e){let t=this.render(e);return console.log(t),t=JSON5.parse(t),_.includes(["bubble","carousel"],_.get(t,"type"))&&(t={type:"flex",altText:this.$t("flexAltText"),contents:t}),t=_.castArray(t),t},paramBase64url(e,t){e=new URL(location).searchParams.get(e);return _.isNil(e)?t:window.decodeBase64url(e)},showLoading(e,t){Swal.fire({title:e,text:t,allowOutsideClick:!1,showConfirmButton:!1,willOpen:()=>{Swal.showLoading()}})}}});</script></body></html>